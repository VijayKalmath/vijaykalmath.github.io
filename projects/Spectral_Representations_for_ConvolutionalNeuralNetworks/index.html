<!DOCTYPE html> <html lang="en"> <head> <meta name="google-site-verification" content="SUIWaGS_bqL-07kpchrmdlwKL6vkr5JXP8xNpoGHnIU"/> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Spectral Representations for Convolutional Neural Networks | Vijay S. Kalmath</title> <meta name="author" content="Vijay S. Kalmath"/> <meta name="description" content="Implementation of Spectral Representations for Convolutional Neural Networks"/> <meta name="keywords" content="kalmath,Vijay Columbia, vijay,Vijay,Kalmath,Vijay Kalmath,vijay kalmath,vijaykalmath,machine-learning,deep-learning,columbia university machine learning,machine learning research assistant,deep learning,deep learning research assistant,data-science,Adversarial Training, Model-Compression,K-Branch CNN, BigEarthNet,Vijay EDAV,Vijay Cisco,Vijay ACI,AImodelshare"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/deep_learning.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://vijaykalmath.github.io/projects/Spectral_Representations_for_ConvolutionalNeuralNetworks/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://vijaykalmath.github.io/">Vijay S. Kalmath</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">Projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Github</a> </li> <li class="nav-item"> <a class="nav-link active" href="https://vijaykalmath.github.io/assets/pdf/Kalmath,Vijay_Resume_2023.pdf">Resume</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Spectral Representations for Convolutional Neural Networks</h1> <p class="post-description">Implementation of Spectral Representations for Convolutional Neural Networks</p> </header> <article> <p>The project is based on the the 2015 Paper by Oren Rippel et.al. <a href="https://arxiv.org/pdf/1506.03767.pdf" target="_blank" rel="noopener noreferrer">Arxiv Link</a></p> <p>The proposals in the paper are aimed at improving the performance of Convolutional Neural Networks by exploiting the spectral domain of images (Fast Fourier Transforms are used to quickly convert images from spatial to spectral domain).</p> <p>Essentially the proposals can be summarized into two main hypothesis :</p> <ol> <li> <code class="language-plaintext highlighter-rouge">Spectral Pooling</code> where the pooling operation happens in the spectral domain of the input images.</li> <li> <code class="language-plaintext highlighter-rouge">Spectral Dropout</code> where frequencies are stochastically choosen to be dropped to mimic the regularization effect of standard dropout.</li> <li> <code class="language-plaintext highlighter-rouge">Spectral Parameterization</code> where the image filters are initialized in the spectral domain.</li> </ol> <p>We were able to successful implement all the Novel Ideas presented in the paper and replicate the results seen by the Authors.</p> <hr> <h2 id="spectral-pooling">Spectral Pooling</h2> <p>Spectral Pooling is a <code class="language-plaintext highlighter-rouge">dimension reduction technique</code> the authors introduced wherein the spectral representation of the image is truncated using a low pass filter and the image is later rebuilt with inverse transformations.</p> <p>This technique is supported by the fact that higher frequencies in the spectral representations of the images tend to encode noise and edges. Removing these frequencies leads to both dimension reduction while minimizing the loss of information.</p> <p>The implementation involves :</p> <ol> <li>DFT of the image and shifting of the zero-frequency component.</li> <li>Implement a low pass filter and process the DFT image with the filter.</li> <li>DFT images after low pass need to adhere to standards which involves treating corner cases when the shapes are odds.</li> <li>Take Inverse DFT to get the spatial representation of the new image.</li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/spectral_representations/grayscale_pooling-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/spectral_representations/grayscale_pooling-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/spectral_representations/grayscale_pooling-1400.webp"></source> <img src="/assets/img/spectral_representations/grayscale_pooling.png" class="img-fluid" width="auto" height="auto" title="Grayscale spectral Pooling" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Spectral Pooling for grayscale Images </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/spectral_representations/rgb_pooling-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/spectral_representations/rgb_pooling-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/spectral_representations/rgb_pooling-1400.webp"></source> <img src="/assets/img/spectral_representations/rgb_pooling.png" class="img-fluid" width="auto" height="auto" title="Rgb spectral Pooling" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Spectral Pooling for RGB Images </div> <p>The first row is the images after max pooling with the dimension reduction ratio described below. The second row is the image after spectral pooling with the same dimension reduction ratio applied to the spectral representation. The third row is a visualization of the frequencies that are kept after the low pass filter for the given dimension reduction ratio.</p> <p>We can clearly see that the spectral pooling is much better at keeping the overall structure of the image intact through the extreme amounts of pooling.</p> <p>We can see that in the most extreme case of dimension reduction (by a factor of 4096), the max pooling output has lost all resemblances to the original image but in the spectral pooling with just 8 frequencies , we can still see the silhouette of the man taking the photo.</p> <h2 id="spectral-representation">Spectral Representation</h2> <p>In traditional CNN all the learnable parameters (weights of the filter as well as the associated bias terms) are defined in the real (spatial) domain.</p> <p>In this implementation however, the aim was to design a CNN with spectrally parameterized filters.</p> <p>We did this by initializing our parameter weights as complex valued coefficients of the DFT of the filter weights rather than the filter weights themselves.</p> <p>To do this we first created a custom <code class="language-plaintext highlighter-rouge">spectralConv2D</code> layer in Keras.</p> <p>Within this layer we built two separate kernels for representing the real and imaginary parts of our complex-valued kernel.</p> <p>This was done since Keras doesnâ€™t provide support for learning complex parameters directly. Next, we combine these two kernels into a single complex filter using tf.complex.</p> <p>We then take the inverse DFT of this filter so as to get its spatial representation which is ultimately used in the convolution operation with the input tensor (which was already in the spatial domain).</p> <hr> <h2 id="results">Results</h2> <p>We built different CNN architectures and their spectral equivalent wherein the Convolutional Layers are replaced with spectral CNNs , max-pooling layers are replaced with spectral pooling and dropout layers with spectral dropout layers.</p> <p>The trainings show that the spectral CNN Architectures were always faster in attaining the validation accuracy achieved by the standard CNN Architecture.</p> <p>The Spectral CNN Architectures showed training speed-up by almost <code class="language-plaintext highlighter-rouge">2.1 to 5</code> times.</p> <p>Furthermore the Spectral CNNs were able to achieve <code class="language-plaintext highlighter-rouge">higher validation accuracy</code> with respect to the standard CNN architecture.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> Â© Copyright 2023 Vijay S. Kalmath. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Last updated: December 12, 2023. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-L767ZJE8EN"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-L767ZJE8EN");</script> </body> </html>